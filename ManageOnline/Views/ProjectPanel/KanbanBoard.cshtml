@using ManageOnline.Models
@model ManageOnline.Models.ProjectModel

@{
    ViewBag.Title = "KanbanBoard";
    Layout = "~/Views/Shared/_Dashboard.cshtml";
}
<script src='//production-assets.codepen.io/assets/editor/live/console_runner-079c09a0e3b9ff743e39ee2d5637b9216b3545af0de366d4b9aad9dc87e26bfd.js'></script>
<script src='//production-assets.codepen.io/assets/editor/live/events_runner-73716630c22bbc8cff4bd0f07b135f00a0bdc5d14629260c3ec49e5606f98fdd.js'></script>
<script src='//production-assets.codepen.io/assets/editor/live/css_live_reload_init-2c0dc5167d60a5af3ee189d570b1835129687ea2a61bee3513dee3a50c115a77.js'></script><meta charset='UTF-8'><meta name="robots" content="noindex"><link rel="shortcut icon" type="image/x-icon" href="//production-assets.codepen.io/assets/favicon/favicon-8ea04875e70c4b0bb41da869e81236e54394d63638a1ef12fa558a4a835f1164.ico" /><link rel="mask-icon" type="" href="//production-assets.codepen.io/assets/favicon/logo-pin-f2d2b6d2c61838f7e76325261b7195c27224080bc099486ddd6dccb469b8e8e6.svg" color="#111" /><link rel="canonical" href="https://codepen.io/clemer/pen/MvvamY?limit=all&page=5&q=uikit" />

<link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-beta.28/css/uikit.min.css'>
<style class="cp-pen-styles">
    .uk-flex-none {
        flex: none !important;
    }

    /**
     * Custom CSS
    **/
    .uk-card-title > small {
        font-size: 50%;
    }

    .user-group {
        padding-left: 15px;
    }

        .user-group > li {
            display: inline;
        }

            .user-group > li:before, .user-group > li:after {
                content: none;
            }

            .user-group > li:hover > img {
                transform: scale(1.3);
                cursor: pointer;
                z-index: 10;
            }

            .user-group > li > img {
                border: 2px solid #fff;
                margin-left: -15px;
                position: relative;
            }
</style>
<script src="~/Scripts/jquery-ui-1.12.1.min.js"></script>




<script type="text/javascript">


    $(function () {
        $("#sortable1, #sortable2, #sortable3").sortable({
            connectWith: ".connectedSortable",
            update: function () {
                var columnFromKanban1 = $('#sortable1').sortable('toArray').toString();
                var columnFromKanban2 = $('#sortable2').sortable('toArray').toString();
                var columnFromKanban3 = $('#sortable3').sortable('toArray').toString();

                alert("Order 1:" + columnFromKanban1 + "\n Order 2:" + columnFromKanban2+  "\, order3: " + columnFromKanban3); //Just showing update
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("UpdateTaskPosition","Task")',
                    data: {
                        column1: columnFromKanban1,
                        column2: columnFromKanban2,
                        column3: columnFromKanban3
                    },
                    success: function (data) {
                        var toast = Metro.toast.create;
                        toast("Status zadania został zaktualizowany", null, 3000, "bg-green fg-white");
                    }
                });

            }
        }).disableSelection();
    });

</script>
<center>
    <h2>@Model.ProjectTitle</h2>
</center>
<ul class="nav nav-pills nav-fill" style="margin-top: 30px">
    <li class="nav-item">
        <a onclick="location.href = '@Url.Action("ProjectPanel", "ProjectPanel", new { projectId=Model.ProjectId}, null)'" class="nav-link ">Informacje</a>
    </li>
    <li class="nav-item">
        <a onclick="location.href = '@Url.Action("KanbanBoard", "ProjectPanel", new { projectId=Model.ProjectId}, null)'" class="nav-link active">Kanban board</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#">Pokój konferencyjny</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#">Pracownicy</a>
    </li>
</ul>

<div>
    @Html.Action("AddTask", "Task", Model.ProjectId)
</div>

<div class="col-12" id="kanbanBoard">
    <div class="row">
        <div class="col-4 kanbanColumn" style="cursor: pointer">
            <h3>Do zrobienia</h3>
            <ul id="sortable1" class="connectedSortable">
                @foreach (var task in Model.Tasks.Where(task => task.ColumnNumber == 1))
                {
                    <div class="uk-margin" id='@task.TaskId'>
                        <div class="uk-card uk-card-hover uk-card-default uk-card-small" >
                            <div class="uk-card-body">
                                <h3 class="uk-card-title uk-margin-remove">
                                    @task.TaskName
                                </h3>
                                <p class="uk-text-meta uk-margin-remove">Lorem ipsum dolor sit amet</p>
                            </div>
                            <div class="uk-card-footer uk-background-muted">
                                @if (task.CurrentWorkerAtTask != null)
                                {
                                    <ul class="user-group">
                                        <img class="uk-border-circle uk-box-shadow-hover-medium" style="height: 40px; width: 40px" src="data:image;base64,@System.Convert.ToBase64String(task.CurrentWorkerAtTask.UserPhoto)">
                                        bebe
                                    </ul>
                                }
                            </div>
                        </div>
                    </div>
                }
            </ul>
        </div>

        <div class="col-4 kanbanColumn" style="cursor: pointer">
            <h3>W trakcie</h3>
            <ul id="sortable2" class="connectedSortable">
                @foreach (var task in Model.Tasks.Where(task => task.ColumnNumber == 2))
                {
                    <div class="uk-margin" id='@task.TaskId'>
                        <div class="uk-card uk-card-hover uk-card-default uk-card-small" >
                            <div class="uk-card-body">
                                <h3 class="uk-card-title uk-margin-remove">Job title <small class="uk-text-muted uk-float-right">#1001</small></h3>
                                <p class="uk-text-meta uk-margin-remove">Lorem ipsum dolor sit amet</p>
                                @if (task.CurrentWorkerAtTask != null)
                                {
                                    <ul class="user-group">
                                        <img class="uk-border-circle uk-box-shadow-hover-medium" style="height: 40px; width: 40px" src="data:image;base64,@System.Convert.ToBase64String(task.CurrentWorkerAtTask.UserPhoto)">
                                        bebe
                                    </ul>
                                }
                            </div>
                            <div class="uk-card-footer uk-background-muted">
                                bebe
                            </div>
                        </div>
                    </div>
                }
            </ul>
        </div>
        <div class="col-4 kanbanColumn" style="cursor: pointer">
            <h3>Zakończone</h3>
            <ul id="sortable3" class="connectedSortable">
                @foreach (var task in Model.Tasks.Where(task => task.ColumnNumber == 3))
                {
                    <div class="uk-margin" id='@task.TaskId'>
                        <div class="uk-card uk-card-hover uk-card-default uk-card-small" >
                            <div class="uk-card-body">
                                <h3 class="uk-card-title uk-margin-remove">Job title <small class="uk-text-muted uk-float-right">#1001</small></h3>
                                <p class="uk-text-meta uk-margin-remove">Lorem ipsum dolor sit amet</p>
                                @if (task.CurrentWorkerAtTask != null)
    {
                            <ul class="user-group">
                                <img class="uk-border-circle uk-box-shadow-hover-medium" style="height: 40px; width: 40px" src="data:image;base64,@System.Convert.ToBase64String(task.CurrentWorkerAtTask.UserPhoto)">
                                bebe
                            </ul>}
                            </div>
                            <div class="uk-card-footer uk-background-muted">
                                bebe
                            </div>
                        </div>
                    </div>
                }
            </ul>
        </div>
    </div>
</div>

<div id="detailsPlace"></div>

<a class="btn btn-primary" href="@Url.Action("ProjectPanel","ProjectPanel",new { projectId=Model.ProjectId}, null)">update</a>

<h2>ProjectPanel</h2>



<div class="modal fade" id="taskModal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" id="modalBodyAddTask">

            </div>
        </div>
    </div>
</div>




